<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to `ci`: Confidence Intervals for Education ‚Ä¢ ci</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to `ci`: Confidence Intervals for Education">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ci</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/ci.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/GegznaV/ci/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to <code>ci</code>: Confidence
Intervals for Education</h1>
                        <h4 data-toc-skip class="author">Vilmantas
Gegzna</h4>
            
            <h4 data-toc-skip class="date">2025-10-19</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/GegznaV/ci/blob/main/vignettes/ci.Rmd" class="external-link"><code>vignettes/ci.Rmd</code></a></small>
      <div class="hidden name"><code>ci.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/GegznaV/ci" class="external-link">ci</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 class="unnumbered" id="abbreviations">Abbreviations<a class="anchor" aria-label="anchor" href="#abbreviations"></a>
</h2>
<ul>
<li>CI ‚Äì Confidence Interval</li>
<li>M ‚Äì Mean</li>
<li>SD ‚Äì Standard Deviation</li>
<li>n ‚Äì Sample Size</li>
<li>Prop ‚Äì Proportion</li>
<li>IQR ‚Äì Interquartile Range</li>
<li>BCa ‚Äì Bias-Corrected and Accelerated (a bootstrap CI method)</li>
</ul>
</div>
<div class="section level2">
<h2 id="about-the-package">About the Package<a class="anchor" aria-label="anchor" href="#about-the-package"></a>
</h2>
<p>Package <code>ci</code> (v0.0.1) is an educational package providing
intuitive functions for calculating confidence intervals (CI) for
various statistical parameters. Designed primarily for teaching and
learning about statistical inference (particularly confidence
intervals), the package offers user-friendly wrappers around established
methods for:</p>
<ul>
<li>
<strong>Proportions</strong> (binary and multinomial)</li>
<li>
<strong>Means</strong> (from data or descriptive statistics)</li>
<li>
<strong>Bootstrap-based intervals</strong> (for any statistic)</li>
</ul>
<p>All functions integrate seamlessly with Tidyverse workflows, making
them ideal for classroom demonstrations and student exercises.</p>
<p>This vignette will introduce you to the concept of CIs and show you
how to use the <code>ci</code> package to calculate and visualize
them.</p>
<div class="section level3">
<h3 id="functions-in-this-package">Functions in This Package<a class="anchor" aria-label="anchor" href="#functions-in-this-package"></a>
</h3>
<table class="table">
<colgroup>
<col width="25%">
<col width="25%">
<col width="25%">
<col width="25%">
</colgroup>
<thead><tr class="header">
<th>Function</th>
<th>Purpose</th>
<th>Input Data</th>
<th>Output Data</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code><a href="../reference/ci_binom.html">ci_binom()</a></code></td>
<td>Proportion CI</td>
<td>Summary statistics (frequencies)</td>
<td>Data frame</td>
</tr>
<tr class="even">
<td><code><a href="../reference/ci_multinom.html">ci_multinom()</a></code></td>
<td>Proportion CI</td>
<td>Summary statistics (frequencies)</td>
<td>Data frame</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/ci_mean_t.html">ci_mean_t()</a></code></td>
<td>Mean CI</td>
<td>Data frame</td>
<td>Data frame</td>
</tr>
<tr class="even">
<td><code><a href="../reference/ci_mean_t_stat.html">ci_mean_t_stat()</a></code></td>
<td>Mean CI</td>
<td>Summary statistics (M, SD, n)</td>
<td>Data frame</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/ci_boot.html">ci_boot()</a></code></td>
<td>Any statistic CI</td>
<td>Data frame</td>
<td>Data frame</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="quick-reference">Quick Reference<a class="anchor" aria-label="anchor" href="#quick-reference"></a>
</h3>
<p>The most common use case examples:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Binomial CI: two categories (e.g., mutant/wild-type)</span></span>
<span><span class="fu"><a href="../reference/ci_binom.html">ci_binom</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">54</span>, n <span class="op">=</span> <span class="fl">80</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Multinomial CI: 3+ categories (e.g., blood types)</span></span>
<span><span class="fu"><a href="../reference/ci_multinom.html">ci_multinom</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span> <span class="op">=</span> <span class="fl">20</span>, <span class="st">"B"</span> <span class="op">=</span> <span class="fl">35</span>, <span class="st">"AB"</span> <span class="op">=</span> <span class="fl">25</span>, <span class="st">"O"</span> <span class="op">=</span> <span class="fl">15</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Mean CI based on data: average with groups</span></span>
<span><span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">group_var</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/ci_mean_t.html">ci_mean_t</a></span><span class="op">(</span><span class="va">numeric_var</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Mean CI based on summary statistics (mean, SD, n): e.g., literature values</span></span>
<span><span class="fu"><a href="../reference/ci_mean_t_stat.html">ci_mean_t_stat</a></span><span class="op">(</span>mean_ <span class="op">=</span> <span class="fl">75</span>, sd_ <span class="op">=</span> <span class="fl">10</span>, n <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Any statistic (median, correlation, etc.)</span></span>
<span><span class="va">data</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/ci_boot.html">ci_boot</a></span><span class="op">(</span><span class="va">var1</span>, <span class="va">var2</span>, FUN <span class="op">=</span> <span class="va">cor</span>, R <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="getting-help">Getting Help<a class="anchor" aria-label="anchor" href="#getting-help"></a>
</h3>
<ul>
<li>Report bugs: <a href="https://github.com/GegznaV/ci/issues" class="external-link uri">https://github.com/GegznaV/ci/issues</a>
</li>
<li>Package documentation: <code>?ci</code> or
<code><a href="https://rdrr.io/pkg/ci/man" class="external-link">help(package = "ci")</a></code>
</li>
<li>Function help: <code><a href="../reference/ci_mean_t.html">?ci::ci_mean_t</a></code>,
<code><a href="../reference/ci_binom.html">?ci::ci_binom</a></code>, etc.</li>
<li>For more statistical background, consult introductory statistics
textbooks</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="the-basics-of-confidence-intervals">The Basics of Confidence Intervals<a class="anchor" aria-label="anchor" href="#the-basics-of-confidence-intervals"></a>
</h2>
<div class="section level3">
<h3 id="what-is-a-confidence-interval">What is a Confidence Interval?<a class="anchor" aria-label="anchor" href="#what-is-a-confidence-interval"></a>
</h3>
<p><strong>Confidence interval</strong> (<strong>CI</strong>) is a
fundamental concept in statistics, providing a range of values that
likely contain the true population parameter. They help quantify the
uncertainty associated with sample estimates.</p>
<p>Imagine you want to know the average height of all students in your
university. You can‚Äôt measure everyone, so you measure 100 students and
find their average height is 170 cm. But would a different group of 100
students give exactly the same average? Probably not.</p>
<p>A <strong>confidence interval</strong> gives you a range of plausible
values for the true population average. Instead of saying ‚Äúthe average
is 170 cm,‚Äù you might say ‚ÄúI‚Äôm 95% confident the true average is between
168 cm and 172 cm.‚Äù</p>
</div>
<div class="section level3">
<h3 id="key-concepts">Key Concepts<a class="anchor" aria-label="anchor" href="#key-concepts"></a>
</h3>
<p><strong>Population vs Sample:</strong></p>
<ul>
<li>
<strong>Population</strong>: Everyone or everything you want to know
about (all organisms in a species, all cells in a tissue)</li>
<li>
<strong>Sample</strong>: The group you actually study (your 100
organisms, your cultured cells)</li>
</ul>
<p><strong>Parameter vs Statistic:</strong></p>
<ul>
<li>
<strong>Parameter</strong>: The true value in the population
(unknown)</li>
<li>
<strong>Statistic</strong>: What you calculate from your sample
(known)</li>
</ul>
<p><strong>Confidence Level:</strong></p>
<ul>
<li>
<strong>95% confidence</strong>: If you repeated your study 100
times, about 95 of your confidence intervals would contain the true
population value.</li>
<li>Common levels: 90%, 95%, 99%</li>
<li>Higher confidence = wider intervals</li>
</ul>
<p><strong>Key Point</strong>: The interval either contains the true
value or it doesn‚Äôt. The ‚Äú95%‚Äù refers to how often the method works, not
the probability for any single interval.</p>
</div>
<div class="section level3">
<h3 id="what-affects-confidence-interval-width">What Affects Confidence Interval Width?<a class="anchor" aria-label="anchor" href="#what-affects-confidence-interval-width"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>Sample size</strong>: Larger samples ‚Üí narrower intervals
(more precise)</li>
<li>
<strong>Confidence level</strong>: Higher confidence ‚Üí wider
intervals</li>
<li>
<strong>Data variability</strong>: More spread in data ‚Üí wider
intervals</li>
</ol>
</div>
<div class="section level3">
<h3 id="terms-you-should-know">Terms You Should Know<a class="anchor" aria-label="anchor" href="#terms-you-should-know"></a>
</h3>
<ul>
<li>
<strong>CI</strong>: Confidence Interval</li>
<li>
<strong>Proportion</strong>: Fraction with a certain characteristic
(e.g., 60% of cells express a marker)</li>
<li>
<strong>Binary</strong>: Two categories (yes/no,
mutant/wild-type)</li>
<li>
<strong>Multinomial</strong>: Three or more categories (blood types
A/B/AB/O)</li>
<li>
<strong>Bootstrap</strong>: A computer method that resamples your
data to estimate uncertainty</li>
</ul>
</div>
<div class="section level3">
<h3 id="common-mistakes-to-avoid">Common Mistakes to Avoid<a class="anchor" aria-label="anchor" href="#common-mistakes-to-avoid"></a>
</h3>
<p>‚ùå <strong>Wrong</strong>: ‚Äú95% probability the true value is in this
interval‚Äù<br>
‚úÖ <strong>Right</strong>: ‚ÄúWe‚Äôre 95% <em>confident</em> the true value
is in this interval‚Äù</p>
<p>‚ùå <strong>Wrong</strong>: Making intervals narrower by changing
confidence level<br>
‚úÖ <strong>Right</strong>: Choose confidence level before calculating
(usually 95%)</p>
</div>
<div class="section level3">
<h3 id="practical-tips">Practical Tips<a class="anchor" aria-label="anchor" href="#practical-tips"></a>
</h3>
<p><strong>Choosing Confidence Level:</strong></p>
<ul>
<li>
<strong>95%</strong> is standard in most fields</li>
<li>
<strong>99%</strong> for critical decisions (clinical trials, safety
studies)</li>
<li>
<strong>90%</strong> sometimes used for preliminary or exploratory
studies</li>
<li>
<strong>Choose before</strong> calculating, not after!</li>
</ul>
<p><strong>Interpreting Results:</strong></p>
<ul>
<li>
<strong>Overlapping intervals</strong>: Difference might not be
meaningful</li>
<li>
<strong>Non-overlapping intervals</strong>: Likely meaningful
difference</li>
<li>
<strong>Width matters</strong>: Narrow intervals are more
informative</li>
<li>
<strong>Context matters</strong>: Statistical difference is not the
same as practical/biological importance</li>
</ul>
<p><strong>Sample Size Planning:</strong></p>
<ul>
<li>Larger samples give more precise estimates</li>
<li>But there are diminishing returns</li>
<li>Consider cost vs precision tradeoffs</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="ci-of-proportion">CI of Proportion<a class="anchor" aria-label="anchor" href="#ci-of-proportion"></a>
</h2>
<div class="section level3">
<h3 id="binomial-proportions-two-categories">Binomial Proportions: Two Categories<a class="anchor" aria-label="anchor" href="#binomial-proportions-two-categories"></a>
</h3>
<p>Binomial proportion CI measures the uncertainty around a proportion
in binary outcomes (i.e., two categories like mutant/wild-type,
diseased/healthy, success/failure, yes/no).</p>
<p>To calculate confidence intervals in this case:</p>
<ol style="list-style-type: decimal">
<li>Create a frequency table of values.</li>
<li>Use frequency of value of interest as <code>x</code> and total
<code>n</code> as input to <code><a href="../reference/ci_binom.html">ci_binom()</a></code>.</li>
</ol>
<p><strong>Scenario</strong>: You investigate 80 <em>Drosophila</em>
specimens (<code>n = 80</code>) and 54 have no mutation
(<code>x = 54</code>).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 54 out of 80 Drosophila are mutation-free</span></span>
<span><span class="fu"><a href="../reference/ci_binom.html">ci_binom</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">54</span>, n <span class="op">=</span> <span class="fl">80</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 √ó 5</span></span></span>
<span><span class="co">#&gt;     est lwr.ci upr.ci     x     n</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 0.675  0.566  0.768    54    80</span></span></code></pre></div>
<p><strong>Interpretation</strong>: We are 95% confident that between
56.6% and 76.8% of the population are mutation-free.</p>
<div class="section level4">
<h4 id="effect-of-sample-size">Effect of Sample Size<a class="anchor" aria-label="anchor" href="#effect-of-sample-size"></a>
</h4>
<p>Let‚Äôs simulate results with same proportion (67.5%) but different
sample sizes:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ci_n1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ci_binom.html">ci_binom</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">54</span>, n <span class="op">=</span> <span class="fl">80</span><span class="op">)</span> <span class="co"># Small sample</span></span>
<span><span class="va">ci_n2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ci_binom.html">ci_binom</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">135</span>, n <span class="op">=</span> <span class="fl">200</span><span class="op">)</span> <span class="co"># Larger sample</span></span>
<span><span class="va">ci_n3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ci_binom.html">ci_binom</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">675</span>, n <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span> <span class="co"># Even larger sample</span></span></code></pre></div>
<p>Now let‚Äôs merge all the results and calculate difference between
upper and lower CI bounds:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">ci_n1</span>, <span class="va">ci_n2</span>, <span class="va">ci_n3</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>diff_upr_lwr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">upr.ci</span> <span class="op">-</span> <span class="va">lwr.ci</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 √ó 6</span></span></span>
<span><span class="co">#&gt;     est lwr.ci upr.ci     x     n diff_upr_lwr</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 0.675  0.566  0.768    54    80        0.201</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 0.675  0.607  0.736   135   200        0.129</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 0.675  0.645  0.703   675  <span style="text-decoration: underline;">1</span>000        0.058</span></span></code></pre></div>
<p>üí° <strong>Notice</strong>: Larger samples give narrower (more
precise) intervals. This is true not only for proportions but also for
means and other statistics.</p>
</div>
<div class="section level4">
<h4 id="effect-of-confidence-levels">Effect of Confidence Levels<a class="anchor" aria-label="anchor" href="#effect-of-confidence-levels"></a>
</h4>
<p>Let‚Äôs see how confidence level affects interval width:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ci_q1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ci_binom.html">ci_binom</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">54</span>, n <span class="op">=</span> <span class="fl">80</span>, conf.level <span class="op">=</span> <span class="fl">0.90</span><span class="op">)</span> <span class="co"># Less confident, narrower</span></span>
<span><span class="va">ci_q2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ci_binom.html">ci_binom</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">54</span>, n <span class="op">=</span> <span class="fl">80</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span> <span class="co"># Standard</span></span>
<span><span class="va">ci_q3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ci_binom.html">ci_binom</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">54</span>, n <span class="op">=</span> <span class="fl">80</span>, conf.level <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span> <span class="co"># More confident, wider</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">ci_q1</span>, <span class="va">ci_q2</span>, <span class="va">ci_q3</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>diff_upr_lwr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">upr.ci</span> <span class="op">-</span> <span class="va">lwr.ci</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 √ó 6</span></span></span>
<span><span class="co">#&gt;     est lwr.ci upr.ci     x     n diff_upr_lwr</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 0.675  0.584  0.754    54    80        0.17 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 0.675  0.566  0.768    54    80        0.201</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 0.675  0.531  0.792    54    80        0.261</span></span></code></pre></div>
<p>üí° <strong>Notice</strong>: Higher confidence levels give wider
intervals.</p>
<p>‚ö†Ô∏è This is just an educational example. Always choose the confidence
level based on your study design before calculating CIs.</p>
</div>
</div>
<div class="section level3">
<h3 id="multinomial-proportions-several-categories">Multinomial Proportions: Several Categories<a class="anchor" aria-label="anchor" href="#multinomial-proportions-several-categories"></a>
</h3>
<p>Multinomial proportion CI measures uncertainty around proportions in
categorical outcomes with 3 or more categories (e.g., A/B/AB/O blood
types, eye colors, genotypes).</p>
<p>In this case:</p>
<ol style="list-style-type: decimal">
<li>Create a frequency table of values.</li>
<li>Use frequencies as input to <code><a href="../reference/ci_multinom.html">ci_multinom()</a></code>.</li>
</ol>
<p><strong>Scenario</strong>: Blood type distribution in patients with a
certain medical condition.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Blood type distribution</span></span>
<span><span class="va">blood_types</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span> <span class="op">=</span> <span class="fl">20</span>, <span class="st">"B"</span> <span class="op">=</span> <span class="fl">35</span>, <span class="st">"AB"</span> <span class="op">=</span> <span class="fl">25</span>, <span class="st">"O"</span> <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/ci_multinom.html">ci_multinom</a></span><span class="op">(</span><span class="va">blood_types</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 √ó 6</span></span></span>
<span><span class="co">#&gt;   group   est lwr.ci upr.ci     x     n</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> A     0.211 0.126   0.331    20    95</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> B     0.368 0.257   0.497    35    95</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> AB    0.263 0.167   0.388    25    95</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> O     0.158 0.086<span style="text-decoration: underline;">0</span>  0.272    15    95</span></span></code></pre></div>
<p><strong>Scenario</strong>: You survey lab members about their
preferred method of commuting to the university.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Transportation preferences</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Car"</span> <span class="op">=</span> <span class="fl">20</span>, <span class="st">"Bus"</span> <span class="op">=</span> <span class="fl">45</span>, <span class="st">"Bike"</span> <span class="op">=</span> <span class="fl">15</span>, <span class="st">"Walk"</span> <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/ci_multinom.html">ci_multinom</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"goodman"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 √ó 6</span></span></span>
<span><span class="co">#&gt;   group   est lwr.ci upr.ci     x     n</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Car    0.2  0.119   0.316    20   100</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Bus    0.45 0.332   0.574    45   100</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Bike   0.15 0.081<span style="text-decoration: underline;">6</span>  0.259    15   100</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Walk   0.2  0.119   0.316    20   100</span></span></code></pre></div>
<p><strong>Interpretation</strong>: We‚Äôre 95% confident that the true
proportion of people who prefer taking the bus is between 32.7% and
57.7%.</p>
<p>In this case, simultaneous CIs are calculated. This means that CIs
are calculated for each category at once, ensuring that the overall
confidence level (e.g., 95%) is maintained across all categories.</p>
</div>
</div>
<div class="section level2">
<h2 id="ci-of-mean-average">CI of Mean (Average)<a class="anchor" aria-label="anchor" href="#ci-of-mean-average"></a>
</h2>
<div class="section level3">
<h3 id="mean-ci-from-data">Mean CI: From Data<a class="anchor" aria-label="anchor" href="#mean-ci-from-data"></a>
</h3>
<p>To calculate confidence intervals for means directly from data
frames, use <code class="sourceCode r"><span class="fu">ci_mean_t</span>()</code>.</p>
<div class="section level4">
<h4 id="overall-mean-no-groups">Overall Mean (No Groups)<a class="anchor" aria-label="anchor" href="#overall-mean-no-groups"></a>
</h4>
<p><strong>Scenario</strong>: You are investigating crop yield.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using built-in dataset as example</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">npk</span>, package <span class="op">=</span> <span class="st">"datasets"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">npk</span>, n <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;   block N P K yield</span></span>
<span><span class="co">#&gt; 1     1 0 1 1  49.5</span></span>
<span><span class="co">#&gt; 2     1 1 1 0  62.8</span></span>
<span><span class="co">#&gt; 3     1 0 0 0  46.8</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Average crop yield (overall)</span></span>
<span><span class="va">npk</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/ci_mean_t.html">ci_mean_t</a></span><span class="op">(</span><span class="va">yield</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 √ó 3</span></span></span>
<span><span class="co">#&gt;    mean lwr.ci upr.ci</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  54.9   52.3   57.5</span></span></code></pre></div>
<p><strong>Interpretation</strong>: We‚Äôre 95% confident the true average
yield is between 51.9 and 56.9.</p>
</div>
<div class="section level4">
<h4 id="comparing-groups">Comparing Groups<a class="anchor" aria-label="anchor" href="#comparing-groups"></a>
</h4>
<p><strong>Scenario</strong>: You are investigating crop yield in
different conditions (with/without fertilizers).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compare yields with and without nitrogen fertilizer</span></span>
<span><span class="va">npk</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/ci_mean_t.html">ci_mean_t</a></span><span class="op">(</span><span class="va">yield</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 √ó 4</span></span></span>
<span><span class="co">#&gt;   N      mean lwr.ci upr.ci</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 0      52.1   48.6   55.5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1      57.7   54.0   61.4</span></span></code></pre></div>
<p>Look at the confidence intervals: if they don‚Äôt overlap, it suggests
a potential difference between groups.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Multiple grouping factors</span></span>
<span><span class="va">npk</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">N</span>, <span class="va">P</span>, <span class="va">K</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/ci_mean_t.html">ci_mean_t</a></span><span class="op">(</span><span class="va">yield</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 8 √ó 6</span></span></span>
<span><span class="co">#&gt;   N     P     K      mean lwr.ci upr.ci</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 0     1     1      50.5   44.6   56.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1     1     0      57.9   44.3   71.5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 0     0     0      51.4   40.0   62.9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 1     0     1      54.7   44.2   65.1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 1     0     0      63.8   51.1   76.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 1     1     1      54.4   41.9   66.8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> 0     0     1      52     38.0   66.0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span> 0     1     0      54.3   31.0   77.7</span></span></code></pre></div>
<p><br></p>
<p><strong>Scenario:</strong> Iris flower measurements.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">iris</span>, package <span class="op">=</span> <span class="st">"datasets"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">iris</span>, n <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span></span>
<span><span class="co">#&gt; 1          5.1         3.5          1.4         0.2  setosa</span></span>
<span><span class="co">#&gt; 2          4.9         3.0          1.4         0.2  setosa</span></span>
<span><span class="co">#&gt; 3          4.7         3.2          1.3         0.2  setosa</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Petal length by flower species</span></span>
<span><span class="va">iris</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Species</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/ci_mean_t.html">ci_mean_t</a></span><span class="op">(</span><span class="va">Petal.Length</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 √ó 4</span></span></span>
<span><span class="co">#&gt;   Species     mean lwr.ci upr.ci</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> setosa      1.46   1.41   1.51</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> versicolor  4.26   4.13   4.39</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> virginica   5.55   5.40   5.71</span></span></code></pre></div>
<p><strong>Interpretation</strong>: The results suggest that the three
species have clearly different petal lengths (no overlapping
intervals).</p>
</div>
</div>
<div class="section level3">
<h3 id="mean-ci-from-summary-statistics">Mean CI: From Summary Statistics<a class="anchor" aria-label="anchor" href="#mean-ci-from-summary-statistics"></a>
</h3>
<p>When you only have descriptive statistics (from literature, reports,
etc.), you may use them directly.</p>
<div class="section level4">
<h4 id="single-group">Single Group<a class="anchor" aria-label="anchor" href="#single-group"></a>
</h4>
<p><strong>Scenario</strong>: You read a study that reports ‚Äúmean = 75,
SD = 10, n = 25‚Äù but doesn‚Äôt give confidence intervals.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate CI from reported statistics</span></span>
<span><span class="fu"><a href="../reference/ci_mean_t_stat.html">ci_mean_t_stat</a></span><span class="op">(</span>mean_ <span class="op">=</span> <span class="fl">75</span>, sd_ <span class="op">=</span> <span class="fl">10</span>, n <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 √ó 6</span></span></span>
<span><span class="co">#&gt;   group  mean lwr.ci upr.ci    sd     n</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> <span style="color: #949494;">""</span>       75   70.9   79.1    10    25</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="comparing-multiple-groups">Comparing Multiple Groups<a class="anchor" aria-label="anchor" href="#comparing-multiple-groups"></a>
</h4>
<p><strong>Scenario:</strong> You compare 3 studies.</p>
<p>You may enter data as vectors:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Three enzyme activity measurements</span></span>
<span><span class="va">mean_val</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">78</span>, <span class="fl">82</span>, <span class="fl">75</span><span class="op">)</span></span>
<span><span class="va">std_dev</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>,   <span class="fl">7</span>,  <span class="fl">9</span><span class="op">)</span></span>
<span><span class="va">n</span>        <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">28</span>, <span class="fl">32</span><span class="op">)</span></span>
<span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Enzyme A"</span>, <span class="st">"Enzyme B"</span>, <span class="st">"Enzyme C"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/ci_mean_t_stat.html">ci_mean_t_stat</a></span><span class="op">(</span><span class="va">mean_val</span>, <span class="va">std_dev</span>, <span class="va">n</span>, <span class="va">group</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 √ó 6</span></span></span>
<span><span class="co">#&gt;   group     mean lwr.ci upr.ci    sd     n</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Enzyme A    78   75.0   81.0     8    30</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Enzyme B    82   79.3   84.7     7    28</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Enzyme C    75   71.8   78.2     9    32</span></span></code></pre></div>
<p>You may enter data as a data frame too. Then use either
<code>$</code> or <code class="sourceCode r"><span class="fu">with</span>()</code> based
syntax:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Three different treatment conditions from literature</span></span>
<span><span class="va">treatments</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>    treatment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Control"</span>, <span class="st">"Low dose"</span>, <span class="st">"High dose"</span><span class="op">)</span>,</span>
<span>    mean_response <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">78</span>, <span class="fl">82</span>, <span class="fl">75</span><span class="op">)</span>,</span>
<span>    sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">7</span>, <span class="fl">9</span><span class="op">)</span>,</span>
<span>    n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">28</span>, <span class="fl">32</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">treatments</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu"><a href="../reference/ci_mean_t_stat.html">ci_mean_t_stat</a></span><span class="op">(</span><span class="va">mean_response</span>, <span class="va">sd</span>, <span class="va">n</span>, <span class="va">treatment</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 √ó 6</span></span></span>
<span><span class="co">#&gt;   group      mean lwr.ci upr.ci    sd     n</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Control      78   75.0   81.0     8    30</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Low dose     82   79.3   84.7     7    28</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> High dose    75   71.8   78.2     9    32</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="exploring-sample-size-effects">Exploring Sample Size Effects<a class="anchor" aria-label="anchor" href="#exploring-sample-size-effects"></a>
</h4>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Same mean and SD but four different sample sizes</span></span>
<span><span class="fu"><a href="../reference/ci_mean_t_stat.html">ci_mean_t_stat</a></span><span class="op">(</span>mean_ <span class="op">=</span> <span class="fl">75</span>, sd_ <span class="op">=</span> <span class="fl">10</span>, n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">25</span>, <span class="fl">50</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 √ó 6</span></span></span>
<span><span class="co">#&gt;   group  mean lwr.ci upr.ci    sd     n</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> <span style="color: #949494;">""</span>       75   67.8   82.2    10    10</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> <span style="color: #949494;">""</span>       75   70.9   79.1    10    25</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> <span style="color: #949494;">""</span>       75   72.2   77.8    10    50</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> <span style="color: #949494;">""</span>       75   73.0   77.0    10   100</span></span></code></pre></div>
<p>Larger samples yield narrower (more precise) confidence intervals.
Doubling sample size doesn‚Äôt halve interval width: the relationship is
not linear.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="bootstrap-confidence-intervals">Bootstrap Confidence Intervals<a class="anchor" aria-label="anchor" href="#bootstrap-confidence-intervals"></a>
</h2>
<p>Bootstrapping methods are based on resampling your data with
replacement to create many ‚Äúbootstrap samples.‚Äù For each sample, the
statistic of interest is calculated. The distribution of these
statistics is then used to estimate confidence intervals.</p>
<p>Bootstrap is useful when:</p>
<ul>
<li>Your data isn‚Äôt normally distributed</li>
<li>You want CIs for statistics other than the mean (median,
correlation, etc.)</li>
<li>You don‚Äôt want to make assumptions about data distribution</li>
</ul>
<p>‚ö†Ô∏è <strong>Warning</strong>: Bootstrap needs adequate sample sizes
(not fewer than 20 per group, preferably 30+ per group).</p>
<p>The main arguments of <code class="sourceCode r"><span class="fu">ci_boot</span>()</code> are:</p>
<ul>
<li>
<code>data</code>: Your data frame. Usually piped in using <code class="sourceCode r"><span class="sc">%&gt;%</span></code> or <code class="sourceCode r"><span class="sc">|&gt;</span></code>.</li>
<li>
<code>x</code>, <code>y</code>: One or two unquoted variable names
to use (<code>y</code> is optional).
<ul>
<li>For single-variable statistics, provide one variable.</li>
<li>For variable-pair statistics, provide two variables.</li>
</ul>
</li>
<li>
<code>FUN</code>: The function to compute the statistic (e.g.,
<code>median</code>, <code>cor</code>, etc.). Use no parentheses after
the function name (e.g., <code>FUN = median</code>, not
<code>FUN = median()</code>).</li>
<li>
<code>...</code>: Additional arguments to pass to <code>FUN</code>
(e.g., <code>method = "pearson"</code> for <code class="sourceCode r"><span class="fu">cor</span>()</code>).</li>
<li>
<code>R</code>: Number of bootstrap resamples (e.g., 1000):
<ul>
<li>Real-life scenarios usually require 1000-10000 resamples.</li>
<li>3000 is often recommended as a first choice.</li>
<li>Higher <code>R</code> gives more accurate CIs but takes longer to
compute.</li>
<li>Use 5000+ for more accuracy if time allows.</li>
</ul>
</li>
<li>
<code>bci.method</code>: Bootstrap CI method:
<ul>
<li>
<code>"bca"</code> for Bias-Corrected and Accelerated (recommended
default)</li>
<li>
<code>"perc"</code> for Percentile method</li>
<li>Other methods as supported by [DescTools::boot.ci()].</li>
</ul>
</li>
</ul>
<p><strong>Use BCa</strong> method when:</p>
<ul>
<li>You have adequate sample size (30+ per group or at least 20 per
group)</li>
<li>You want the most accurate intervals</li>
</ul>
<p><strong>Use percentile</strong> method when:</p>
<ul>
<li>You have small samples</li>
<li>BCa fails or takes too long</li>
<li>You want simpler, more robust results</li>
</ul>
<p>üí° <strong>Advice</strong>: Bootstrap methods give slightly different
results on the same data in different runs due to their random nature.
For reproducibility, set a random seed using <code class="sourceCode r"><span class="fu">set.seed</span>()</code> before
calling <code class="sourceCode r"><span class="fu">ci_boot</span>()</code>.</p>
<div class="section level3">
<h3 id="ci-for-single-variable-statistics">CI for Single-Variable Statistics<a class="anchor" aria-label="anchor" href="#ci-for-single-variable-statistics"></a>
</h3>
<p>Single-variable statistics need only one variable to be computed.
Examples are mean, median, SD, etc.</p>
<p><strong>Median CI</strong></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span> <span class="co"># For reproducible results</span></span>
<span></span>
<span><span class="co"># Median petal length for all flowers</span></span>
<span><span class="va">iris</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/ci_boot.html">ci_boot</a></span><span class="op">(</span><span class="va">Petal.Length</span>, FUN <span class="op">=</span> <span class="va">median</span>, R <span class="op">=</span> <span class="fl">1000</span>, bci.method <span class="op">=</span> <span class="st">"bca"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 √ó 3</span></span></span>
<span><span class="co">#&gt;   median lwr.ci upr.ci</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>   4.35      4   4.54</span></span></code></pre></div>
<p><strong>Median CI by Group</strong></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">456</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Median by species</span></span>
<span><span class="va">iris</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Species</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/ci_boot.html">ci_boot</a></span><span class="op">(</span><span class="va">Petal.Length</span>, FUN <span class="op">=</span> <span class="va">median</span>, R <span class="op">=</span> <span class="fl">1000</span>, bci.method <span class="op">=</span> <span class="st">"bca"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 √ó 4</span></span></span>
<span><span class="co">#&gt;   Species    median lwr.ci upr.ci</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> setosa       1.5     1.4    1.5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> versicolor   4.35    4.1    4.5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> virginica    5.55    5.2    5.6</span></span></code></pre></div>
<p><strong>Standard Deviation CI</strong></p>
<p><strong>When to use</strong>: CIs of variability measures (SD, IQR,
etc.) should be used when you want to know how consistent or variable
your data is.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">789</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># How variable is petal length?</span></span>
<span><span class="va">iris</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/ci_boot.html">ci_boot</a></span><span class="op">(</span><span class="va">Petal.Length</span>, FUN <span class="op">=</span> <span class="va">sd</span>, R <span class="op">=</span> <span class="fl">1000</span>, bci.method <span class="op">=</span> <span class="st">"bca"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 √ó 3</span></span></span>
<span><span class="co">#&gt;      sd lwr.ci upr.ci</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  1.77   1.66   1.88</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="cis-for-variable-pair-statistics">CIs for Variable-Pair Statistics<a class="anchor" aria-label="anchor" href="#cis-for-variable-pair-statistics"></a>
</h3>
<p>Variable-pair statistics need two variables to be computed. Examples
are correlation coefficients (Pearson, Spearman, Kendall), Cram√©r‚Äôs V,
Goodman-Kruskal Tau and Lambda, etc.</p>
<p>Pearson correlation measures the strength of linear relationship
between two continuous variables:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">101</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Relationship between petal length and width for each species</span></span>
<span><span class="va">iris</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Species</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/ci_boot.html">ci_boot</a></span><span class="op">(</span></span>
<span>    <span class="va">Petal.Length</span>, <span class="va">Petal.Width</span>,</span>
<span>    FUN <span class="op">=</span> <span class="va">cor</span>, method <span class="op">=</span> <span class="st">"pearson"</span>,</span>
<span>    R <span class="op">=</span> <span class="fl">1000</span>, bci.method <span class="op">=</span> <span class="st">"bca"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 √ó 4</span></span></span>
<span><span class="co">#&gt;   Species      cor lwr.ci upr.ci</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> setosa     0.332 0.064<span style="text-decoration: underline;">9</span>  0.517</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> versicolor 0.787 0.665   0.868</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> virginica  0.322 0.111   0.514</span></span></code></pre></div>
<p><strong>Note 1</strong>: <code>method</code> is an argument of
function <code class="sourceCode r"><span class="fu">cor</span>()</code>.<br><strong>Note 2</strong>: If the CI does not include 0, there is likely a
real correlation.</p>
<p>Spearman correlation measures rank (monotonic non-linear)
relationship between two continuous variables:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">101</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Correlation between petal length and width</span></span>
<span><span class="va">iris</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Species</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/ci_boot.html">ci_boot</a></span><span class="op">(</span></span>
<span>    <span class="va">Petal.Length</span>, <span class="va">Petal.Width</span>,</span>
<span>    FUN <span class="op">=</span> <span class="va">cor</span>, method <span class="op">=</span> <span class="st">"spearman"</span>,</span>
<span>    R <span class="op">=</span> <span class="fl">1000</span>, bci.method <span class="op">=</span> <span class="st">"bca"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 √ó 4</span></span></span>
<span><span class="co">#&gt;   Species      cor   lwr.ci upr.ci</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> setosa     0.271 -<span style="color: #BB0000;">0.004</span><span style="color: #BB0000; text-decoration: underline;">66</span>  0.510</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> versicolor 0.787  0.615    0.875</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> virginica  0.363  0.111    0.591</span></span></code></pre></div>
<p><strong>Results</strong>: All three species show strong positive
correlations.</p>
</div>
<div class="section level3">
<h3 id="bootstrap-methods-when-to-use-which">Bootstrap Methods: When to Use Which<a class="anchor" aria-label="anchor" href="#bootstrap-methods-when-to-use-which"></a>
</h3>
<p>The package offers several bootstrap methods. They are set using the
<code>bci.method</code> argument. Different methods can give slightly
different results. Let‚Äôs look at two examples:</p>
<ul>
<li>
<code>bca</code> ‚Äì <strong>Bias-Corrected and Accelerated</strong>
(BCa) bootstrap CI (recommended default)</li>
<li>
<code>perc</code> ‚Äì <strong>Percentile</strong> bootstrap CI</li>
</ul>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">222</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Percentile method (simpler, more robust)</span></span>
<span><span class="va">iris</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/ci_boot.html">ci_boot</a></span><span class="op">(</span><span class="va">Petal.Length</span>, FUN <span class="op">=</span> <span class="va">median</span>, R <span class="op">=</span> <span class="fl">1000</span>, bci.method <span class="op">=</span> <span class="st">"perc"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 √ó 3</span></span></span>
<span><span class="co">#&gt;   median lwr.ci upr.ci</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>   4.35      4   4.55</span></span>
<span></span>
<span><span class="co"># BCa method (often more accurate)</span></span>
<span><span class="va">iris</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/ci_boot.html">ci_boot</a></span><span class="op">(</span><span class="va">Petal.Length</span>, FUN <span class="op">=</span> <span class="va">median</span>, R <span class="op">=</span> <span class="fl">1000</span>, bci.method <span class="op">=</span> <span class="st">"bca"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 √ó 3</span></span></span>
<span><span class="co">#&gt;   median lwr.ci upr.ci</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>   4.35      4    4.5</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="learning-exercises">Learning Exercises<a class="anchor" aria-label="anchor" href="#learning-exercises"></a>
</h2>
<div class="section level3">
<h3 id="exercise-1-understanding-confidence-levels">Exercise 1: Understanding Confidence Levels<a class="anchor" aria-label="anchor" href="#exercise-1-understanding-confidence-levels"></a>
</h3>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Same data, different confidence levels</span></span>
<span><span class="fu"><a href="../reference/ci_mean_t_stat.html">ci_mean_t_stat</a></span><span class="op">(</span>mean_ <span class="op">=</span> <span class="fl">75</span>, sd_ <span class="op">=</span> <span class="fl">10</span>, n <span class="op">=</span> <span class="fl">25</span>, conf.level <span class="op">=</span> <span class="fl">0.90</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 √ó 6</span></span></span>
<span><span class="co">#&gt;   group  mean lwr.ci upr.ci    sd     n</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> <span style="color: #949494;">""</span>       75   71.6   78.4    10    25</span></span>
<span><span class="fu"><a href="../reference/ci_mean_t_stat.html">ci_mean_t_stat</a></span><span class="op">(</span>mean_ <span class="op">=</span> <span class="fl">75</span>, sd_ <span class="op">=</span> <span class="fl">10</span>, n <span class="op">=</span> <span class="fl">25</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 √ó 6</span></span></span>
<span><span class="co">#&gt;   group  mean lwr.ci upr.ci    sd     n</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> <span style="color: #949494;">""</span>       75   70.9   79.1    10    25</span></span>
<span><span class="fu"><a href="../reference/ci_mean_t_stat.html">ci_mean_t_stat</a></span><span class="op">(</span>mean_ <span class="op">=</span> <span class="fl">75</span>, sd_ <span class="op">=</span> <span class="fl">10</span>, n <span class="op">=</span> <span class="fl">25</span>, conf.level <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 √ó 6</span></span></span>
<span><span class="co">#&gt;   group  mean lwr.ci upr.ci    sd     n</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> <span style="color: #949494;">""</span>       75   69.4   80.6    10    25</span></span></code></pre></div>
<p><strong>Questions:</strong></p>
<ol style="list-style-type: decimal">
<li>What happens to interval width as confidence level increases?
Why?</li>
</ol>
</div>
<div class="section level3">
<h3 id="exercise-2-sample-size-effect">Exercise 2: Sample Size Effect<a class="anchor" aria-label="anchor" href="#exercise-2-sample-size-effect"></a>
</h3>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Effect of sample size on precision</span></span>
<span><span class="fu"><a href="../reference/ci_mean_t_stat.html">ci_mean_t_stat</a></span><span class="op">(</span>mean_ <span class="op">=</span> <span class="fl">85</span>, sd_ <span class="op">=</span> <span class="fl">15</span>, n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">25</span>, <span class="fl">50</span>, <span class="fl">100</span>, <span class="fl">400</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 √ó 6</span></span></span>
<span><span class="co">#&gt;   group  mean lwr.ci upr.ci    sd     n</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> <span style="color: #949494;">""</span>       85   74.3   95.7    15    10</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> <span style="color: #949494;">""</span>       85   78.8   91.2    15    25</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> <span style="color: #949494;">""</span>       85   80.7   89.3    15    50</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> <span style="color: #949494;">""</span>       85   82.0   88.0    15   100</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> <span style="color: #949494;">""</span>       85   83.5   86.5    15   400</span></span></code></pre></div>
<p><strong>Questions</strong>:</p>
<ol style="list-style-type: decimal">
<li>Which sample size gives the most precise estimate?</li>
<li>Is the improvement from n = 25 to n = 50 the same as from n = 50 to
n = 100?</li>
</ol>
</div>
<div class="section level3">
<h3 id="exercise-3-overlapping-vs-non-overlapping-intervals">Exercise 3: Overlapping vs Non-overlapping Intervals<a class="anchor" aria-label="anchor" href="#exercise-3-overlapping-vs-non-overlapping-intervals"></a>
</h3>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Two treatment methods</span></span>
<span><span class="fu"><a href="../reference/ci_mean_t_stat.html">ci_mean_t_stat</a></span><span class="op">(</span></span>
<span>  mean_ <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">78</span>, <span class="fl">82</span><span class="op">)</span>,</span>
<span>  sd_ <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">7</span><span class="op">)</span>,</span>
<span>  n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">28</span><span class="op">)</span>,</span>
<span>  group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Treatment A"</span>, <span class="st">"Treatment B"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 √ó 6</span></span></span>
<span><span class="co">#&gt;   group        mean lwr.ci upr.ci    sd     n</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Treatment A    78   75.0   81.0     8    30</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Treatment B    82   79.3   84.7     7    28</span></span></code></pre></div>
<p><strong>Questions:</strong></p>
<ol style="list-style-type: decimal">
<li>Do the confidence intervals overlap? What might this suggest about
the difference between treatments?</li>
</ol>
</div>
<div class="section level3">
<h3 id="exercise-4-number-of-bootstrap-resamples">Exercise 4: Number of Bootstrap Resamples<a class="anchor" aria-label="anchor" href="#exercise-4-number-of-bootstrap-resamples"></a>
</h3>
<p>In this exercise, we investigate how the number of bootstrap
resamples (<code>R</code>) affects both computation time and the
precision of confidence intervals. We‚Äôll run the same bootstrap analysis
multiple times with different values of <code>R</code> (500, 1000, 3000,
5000, and 9999) to observe patterns in:</p>
<ul>
<li>
<strong>Computation time</strong>: How long does it take to
calculate CIs?</li>
<li>
<strong>CI width</strong>: How precise are the estimates?</li>
<li>
<strong>Stability</strong>: How much do results vary between runs
with the same <code>R</code>?</li>
</ul>
<p>To avoid repetitive code, we create a helper function <code class="sourceCode r"><span class="fu">simulate_ci</span>()</code>
that:</p>
<ol style="list-style-type: decimal">
<li>Runs <code class="sourceCode r"><span class="fu">ci_boot</span>()</code> with a
specified number of resamples (<code>R</code>)</li>
<li>Measures the elapsed computation time using <code class="sourceCode r"><span class="fu">system.time</span>()</code>
</li>
<li>Returns results with additional information (CI width,
<code>R</code> value, computation time)</li>
</ol>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Function to run bootstrap CI and measure computation time</span></span>
<span><span class="va">simulate_ci</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">R</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># system.time() tracks how long the code takes to run</span></span>
<span>  <span class="va">time_s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span>
<span>    <span class="va">result</span> <span class="op">&lt;-</span> <span class="va">iris</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/ci_boot.html">ci_boot</a></span><span class="op">(</span><span class="va">Petal.Length</span>, FUN <span class="op">=</span> <span class="va">mean</span>, R <span class="op">=</span> <span class="va">R</span>, bci.method <span class="op">=</span> <span class="st">"bca"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Add useful metrics to the results:</span></span>
<span>  <span class="co"># - diff: CI width (difference between upper and lower bounds)</span></span>
<span>  <span class="co"># - R: number of resamples used</span></span>
<span>  <span class="co"># - time_s: elapsed computation time in seconds</span></span>
<span>  <span class="va">result</span> <span class="op">&lt;-</span> <span class="va">result</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>      diff <span class="op">=</span> <span class="op">(</span><span class="va">upr.ci</span> <span class="op">-</span> <span class="va">lwr.ci</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>      upr.ci <span class="op">=</span> <span class="va">upr.ci</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>      lwr.ci <span class="op">=</span> <span class="va">lwr.ci</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>      time_s <span class="op">=</span> <span class="va">time_s</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="co"># [3] extracts elapsed time (wall-clock time),</span></span>
<span>      R <span class="op">=</span> <span class="va">R</span>,</span>
<span>    <span class="op">)</span></span>
<span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Now we run the simulation multiple times (5 replications) for each
value of <code>R</code> to see how results vary:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run simulation with different numbers of bootstrap resamples</span></span>
<span><span class="co"># Each R value is tested 5 times to assess variability</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">307</span><span class="op">)</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span></span>
<span>  <span class="co"># 500 resamples</span></span>
<span>  <span class="fu">simulate_ci</span><span class="op">(</span>R <span class="op">=</span> <span class="fl">500</span><span class="op">)</span>,</span>
<span>  <span class="fu">simulate_ci</span><span class="op">(</span>R <span class="op">=</span> <span class="fl">500</span><span class="op">)</span>,</span>
<span>  <span class="fu">simulate_ci</span><span class="op">(</span>R <span class="op">=</span> <span class="fl">500</span><span class="op">)</span>,</span>
<span>  <span class="fu">simulate_ci</span><span class="op">(</span>R <span class="op">=</span> <span class="fl">500</span><span class="op">)</span>,</span>
<span>  <span class="fu">simulate_ci</span><span class="op">(</span>R <span class="op">=</span> <span class="fl">500</span><span class="op">)</span>,</span>
<span>  <span class="co"># 1000 resamples</span></span>
<span>  <span class="fu">simulate_ci</span><span class="op">(</span>R <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>,</span>
<span>  <span class="fu">simulate_ci</span><span class="op">(</span>R <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>,</span>
<span>  <span class="fu">simulate_ci</span><span class="op">(</span>R <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>,</span>
<span>  <span class="fu">simulate_ci</span><span class="op">(</span>R <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>,</span>
<span>  <span class="fu">simulate_ci</span><span class="op">(</span>R <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>,</span>
<span>  <span class="co"># 3000 resamples</span></span>
<span>  <span class="fu">simulate_ci</span><span class="op">(</span>R <span class="op">=</span> <span class="fl">3000</span><span class="op">)</span>,</span>
<span>  <span class="fu">simulate_ci</span><span class="op">(</span>R <span class="op">=</span> <span class="fl">3000</span><span class="op">)</span>,</span>
<span>  <span class="fu">simulate_ci</span><span class="op">(</span>R <span class="op">=</span> <span class="fl">3000</span><span class="op">)</span>,</span>
<span>  <span class="fu">simulate_ci</span><span class="op">(</span>R <span class="op">=</span> <span class="fl">3000</span><span class="op">)</span>,</span>
<span>  <span class="fu">simulate_ci</span><span class="op">(</span>R <span class="op">=</span> <span class="fl">3000</span><span class="op">)</span>,</span>
<span>  <span class="co"># 5000 resamples</span></span>
<span>  <span class="fu">simulate_ci</span><span class="op">(</span>R <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span>,</span>
<span>  <span class="fu">simulate_ci</span><span class="op">(</span>R <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span>,</span>
<span>  <span class="fu">simulate_ci</span><span class="op">(</span>R <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span>,</span>
<span>  <span class="fu">simulate_ci</span><span class="op">(</span>R <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span>,</span>
<span>  <span class="fu">simulate_ci</span><span class="op">(</span>R <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span>,</span>
<span>  <span class="co"># 9999 resamples</span></span>
<span>  <span class="fu">simulate_ci</span><span class="op">(</span>R <span class="op">=</span> <span class="fl">9999</span><span class="op">)</span>,</span>
<span>  <span class="fu">simulate_ci</span><span class="op">(</span>R <span class="op">=</span> <span class="fl">9999</span><span class="op">)</span>,</span>
<span>  <span class="fu">simulate_ci</span><span class="op">(</span>R <span class="op">=</span> <span class="fl">9999</span><span class="op">)</span>,</span>
<span>  <span class="fu">simulate_ci</span><span class="op">(</span>R <span class="op">=</span> <span class="fl">9999</span><span class="op">)</span>,</span>
<span>  <span class="fu">simulate_ci</span><span class="op">(</span>R <span class="op">=</span> <span class="fl">9999</span><span class="op">)</span>,</span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">results</span>, n <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 25 √ó 6</span></span></span>
<span><span class="co">#&gt;     mean lwr.ci upr.ci  diff time_s     R</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>  3.76   3.49   4.01 0.525 0.033<span style="text-decoration: underline;">0</span>   500</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>  3.76   3.49   4.06 0.573 0.033<span style="text-decoration: underline;">0</span>   500</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>  3.76   3.49   4.02 0.526 0.032<span style="text-decoration: underline;">0</span>   500</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>  3.76   3.46   4.00 0.54  0.033<span style="text-decoration: underline;">0</span>   500</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>  3.76   3.42   4.03 0.612 0.033<span style="text-decoration: underline;">0</span>   500</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>  3.76   3.45   4.01 0.562 0.048<span style="text-decoration: underline;">0</span>  <span style="text-decoration: underline;">1</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>  3.76   3.47   4.06 0.589 0.048<span style="text-decoration: underline;">0</span>  <span style="text-decoration: underline;">1</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>  3.76   3.45   4.03 0.583 0.048<span style="text-decoration: underline;">0</span>  <span style="text-decoration: underline;">1</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>  3.76   3.47   4.03 0.559 0.048<span style="text-decoration: underline;">0</span>  <span style="text-decoration: underline;">1</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  3.76   3.45   4.04 0.587 0.047<span style="text-decoration: underline;">0</span>  <span style="text-decoration: underline;">1</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>  3.76   3.48   4.04 0.562 0.123   <span style="text-decoration: underline;">3</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span>  3.76   3.49   4.04 0.552 0.124   <span style="text-decoration: underline;">3</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span>  3.76   3.48   4.05 0.567 0.125   <span style="text-decoration: underline;">3</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span>  3.76   3.47   4.04 0.571 0.124   <span style="text-decoration: underline;">3</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span>  3.76   3.47   4.05 0.574 0.124   <span style="text-decoration: underline;">3</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span>  3.76   3.46   4.04 0.575 0.344   <span style="text-decoration: underline;">5</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span>  3.76   3.48   4.04 0.558 0.194   <span style="text-decoration: underline;">5</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span>  3.76   3.46   4.03 0.561 0.194   <span style="text-decoration: underline;">5</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span>  3.76   3.47   4.04 0.569 0.192   <span style="text-decoration: underline;">5</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">20</span>  3.76   3.47   4.04 0.572 0.193   <span style="text-decoration: underline;">5</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">21</span>  3.76   3.47   4.03 0.563 0.554   <span style="text-decoration: underline;">9</span>999</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">22</span>  3.76   3.47   4.04 0.572 0.386   <span style="text-decoration: underline;">9</span>999</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">23</span>  3.76   3.48   4.04 0.558 0.366   <span style="text-decoration: underline;">9</span>999</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">24</span>  3.76   3.48   4.03 0.558 0.364   <span style="text-decoration: underline;">9</span>999</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">25</span>  3.76   3.48   4.04 0.554 0.370   <span style="text-decoration: underline;">9</span>999</span></span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Summary by number of replications (R)</span></span>
<span><span class="va">summary_of_results</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">results</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">R</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span></span>
<span>    diff_mean <span class="op">=</span>   <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">diff</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>    diff_sd   <span class="op">=</span>     <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">diff</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>    time_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">time_s</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    time_sd   <span class="op">=</span>   <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">time_s</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">summary_of_results</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 √ó 5</span></span></span>
<span><span class="co">#&gt;       R diff_mean diff_sd time_mean time_sd</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>   500     0.555   0.037      0.03    0   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>  <span style="text-decoration: underline;">1</span>000     0.576   0.014      0.05    0   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>  <span style="text-decoration: underline;">3</span>000     0.565   0.009      0.12    0   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>  <span style="text-decoration: underline;">5</span>000     0.567   0.007      0.22    0.07</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>  <span style="text-decoration: underline;">9</span>999     0.561   0.007      0.41    0.08</span></span></code></pre></div>
<p><strong>Questions:</strong></p>
<ol style="list-style-type: decimal">
<li>How does increasing <code>R</code> affect computation time?</li>
<li>How does increasing <code>R</code> affect the (a) width and (b)
stability of the confidence intervals?</li>
</ol>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Vilmantas Gegzna.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
